const t=window.D3Stencil.h;import{g as a,m as r,i as e,j as i,k as s,l as h}from"./chunk-6e0c6752.js";import{a as o,b as g}from"./chunk-d9a959cc.js";import{b as l,a as d,e as n,c as p,d as c}from"./chunk-e5eef6f6.js";import"./chunk-1767601e.js";import{a as m}from"./chunk-696ad60d.js";class b{componentWillLoad(){this.graphDataMerged=a(Object.assign({},r),this.graphData)}componentDidLoad(){this.svg=o(this.horizontalBarChartEl.getElementsByTagName("svg")[0]),this.height=this.svg.node().getBoundingClientRect().height-this.graphDataMerged.barChart.margin.top-this.graphDataMerged.barChart.margin.bottom,this.initSlots(),this.drawChart()}updateGraphData(t){this.graphDataMerged=a(Object.assign({},r),t),this.drawChart()}drawChart(){if(this.hasData()){this.reSetRoot(),this.width=this.svg.node().getBoundingClientRect().width-this.graphDataMerged.barChart.margin.left-this.graphDataMerged.barChart.margin.right;const t=this.graphDataMerged.data,a=l(t,t=>t);this.x=d().domain([0,100*Math.ceil(a/100)]).range([0,this.width]),this.y=n().domain(t.map((t,a)=>`${this.graphDataMerged.labels[a]}`)).range([this.height,0]).padding(.1),this.drawAxis(),this.drawGrid(),this.drawBars()}}hasData(){return this.graphDataMerged.hasData(this.graphDataMerged)}reSetRoot(){this.root&&this.root.remove(),this.root=this.svg.append("g").attr("transform",`translate(${this.graphDataMerged.barChart.margin.left}, ${this.graphDataMerged.barChart.margin.top})`)}initSlots(){this.tooltipEl=e(this.horizontalBarChartEl),this.legendEl=i(this.horizontalBarChartEl,this.eventsLegend.bind(this))}drawAxis(){this.graphDataMerged.barChart.axis.x.visible&&this.root.append("g").attr("class","x axis").attr("transform",`translate(0, ${this.height})`).call(p(this.x).tickFormat(t=>s(this.graphDataMerged.barChart.axis.x.format,t,this.graphDataMerged.barChart.axis.x.currency))),this.graphDataMerged.barChart.axis.y.visible&&this.root.append("g").attr("class","y axis").call(c(this.y))}drawGrid(){this.graphDataMerged.barChart.axis.x.gridVisible&&this.root.append("g").attr("class","grid").call(p(this.x).tickSize(this.height).tickFormat(()=>"")),this.graphDataMerged.barChart.axis.y.gridVisible&&this.root.append("g").attr("class","grid").call(c(this.y).tickSize(-this.width).tickFormat(()=>""))}drawBars(){this.root.append("g").attr("class","bar-group").selectAll(".bar").data(this.graphDataMerged.data).enter().filter(t=>this.x(t)>0).append("rect").attr("class","bar").attr("x",0).attr("height",this.y.bandwidth()).attr("y",(t,a)=>this.y(`${this.graphDataMerged.labels[a]}`)).attr("width",t=>this.x(t)).attr("fill",(t,a)=>h(this.graphDataMerged.colors,a)).on("mousemove",(t,a)=>this.eventsTooltip({data:t,index:a,isToShow:!0})).on("mouseout",()=>this.eventsTooltip({isToShow:!1}))}eventsTooltip({data:t,index:a,isToShow:r}){this.tooltipEl&&(r?(()=>{this.tooltipEl.show(`${s(this.graphDataMerged.barChart.axis.x.format,t,this.graphDataMerged.barChart.axis.x.currency)} <br/> ${this.graphDataMerged.labels[a]}`,[g.pageX,g.pageY])})():(()=>this.tooltipEl.hide())())}eventsLegend(t){console.log(t)}render(){return t("div",{class:this.legendEl?"o-layout is--vertical":"o-layout"},t("div",{class:"o-layout--chart"},t("svg",{style:this.graphDataMerged.styles})),t("div",{class:"o-layout--slot"},t("slot",{name:"tooltip"}),t("slot",{name:"legend"})))}static get is(){return"horizontal-bar-chart"}static get properties(){return{graphData:{type:"Any",attr:"graph-data"},horizontalBarChartEl:{elementRef:!0},legendEl:{state:!0},tooltipEl:{state:!0},updateGraphData:{method:!0}}}static get style(){return".o-layout{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.o-layout,.o-layout--chart{width:100%}.is--vertical .o-layout--chart{width:90%}.o-layout--slot{width:100%}.is--vertical .o-layout--slot{width:10%;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}horizontal-bar-chart .grid line{stroke:#d3d3d3;stroke-opacity:.7;shape-rendering:crispEdges}horizontal-bar-chart .grid path{stroke-width:0}"}}!function(t,a,r,e){var i,s=arguments.length,h=s<3?a:null===e?e=Object.getOwnPropertyDescriptor(a,r):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,a,r,e);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(h=(s<3?i(h):s>3?i(a,r,h):i(a,r))||h);s>3&&h&&Object.defineProperty(a,r,h)}([m()],b.prototype,"drawChart",null);export{b as HorizontalBarChart};